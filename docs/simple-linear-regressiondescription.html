<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Simple Linear Regression—Description | Statistical Modeling and Computation for Educational Scientists" />
<meta property="og:type" content="book" />


<meta property="og:description" content="EPsy 8251 and 8252 Notes" />
<meta name="github-repo" content="zief0002/modeling" />

<meta name="author" content="Andrew Zieffler" />

<meta name="date" content="2020-05-18" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="EPsy 8251 and 8252 Notes">

<title>Simple Linear Regression—Description | Statistical Modeling and Computation for Educational Scientists</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="style/style.css" type="text/css" />
<link rel="stylesheet" href="style/table-styles.css" type="text/css" />
<link rel="stylesheet" href="style/syntax.css" type="text/css" />
<link rel="stylesheet" href="style/navbar.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#foreword">Foreword</a></li>
<li><a href="preface.html#preface">Preface</a></li>
<li><a href="simple-linear-regressiondescription.html#simple-linear-regressiondescription">Simple Linear Regression—Description</a></li>
<li><a href="references-1.html#references-1">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="simple-linear-regressiondescription" class="section level1">
<h1>Simple Linear Regression—Description</h1>
<p>In this set of notes, you will begin your foray into regression analysis. To do so, we will use the <em>riverview.csv</em> data to examine <strong>whether education level is related to income</strong>. The data contain five attributes collected from a random sample of <span class="math inline">\(n=32\)</span> employees working for the city of Riverview, a hypothetical midwestern city (see the <a href="http://zief0002.github.io/epsy-8251/codebooks/riverview.html">data codebook</a>). To begin, we will load several libraries and import the data into an object called <code>city</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Load libraries</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># Read in data</span></a>
<a class="sourceLine" id="cb1-7" title="7">city =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;https://raw.githubusercontent.com/zief0002/epsy-8251/master/data/riverview.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">head</span>(city)</a></code></pre></div>
<pre><code># A tibble: 6 x 6
  education income seniority gender  male party      
      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;      
1         8   37.4         7 male       1 Democrat   
2         8   26.4         9 female     0 Independent
3        10   47.0        14 male       1 Democrat   
4        10   34.2        16 female     0 Independent
5        10   25.5         1 female     0 Republican 
6        12   46.5        11 female     0 Democrat   </code></pre>
<p><br /></p>
<div id="data-exploration" class="section level2">
<h2>Data Exploration</h2>
<p>Any analysis should start with an initial exploration of the data. During this exploration, you should examine each of the variables that you will be including in the regression analysis. This will help you understand results you get in later analyses, and will also help foreshadow potential problems with the analysis. <a href="https://www.analyticsvidhya.com/blog/2016/01/guide-data-exploration/">This blog post</a> describes initial ideas of data exploration reasonably well. You could also refer to almost any introductory statistics text for additional detail.</p>
<p>It is typical to begin by exploring the distribution of each variable used in the analysis separately. These distributions are referred to as <em>marginal distributions</em>. After that, it is appropriate to explore the relationships between the variables.</p>
<p><br /></p>
<div id="marginal-distribution-of-income" class="section level3">
<h3>Marginal Distribution of Income</h3>
<p>To begin this exploration, we will examine the marginal distribution of employee incomes. We can plot a marginal distribution using functionality from the <strong>ggplot2</strong> package.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> city, <span class="kw">aes</span>(<span class="dt">x =</span> income)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">stat_density</span>(<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Income (in thousands of dollars)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="04-simple-regression-description_files/figure-html/unnamed-chunk-3-1.png" alt="Density plot of employee incomes." width="50%" />
<p class="caption">
Figure 1: Density plot of employee incomes.
</p>
</div>
<p>This plot suggests that the distribution of employee incomes is unimodal and most of the incomes are between roughly $50,000 and $70,000. The smallest income in the sample is about $25,000 and the largest income is over $80,000. This indicates there is a fair amount of variation in the data.</p>
<p>To further summarize the distribution, it is typical to compute and report summary statistics such as the mean and standard deviation. One way to compute these values is to use functions from the <strong>dplyr</strong> library.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">city <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="dt">M =</span> <span class="kw">mean</span>(income),</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="dt">SD =</span> <span class="kw">sd</span>(income)</a>
<a class="sourceLine" id="cb4-5" title="5">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1  53.7  14.6</code></pre>
<p>Describing this variable we might write,</p>
<blockquote>
<p>The marginal distribution of income is unimodal with a mean of approximately $53,700. There is variation in employees’ salaries (SD = $14,500).</p>
</blockquote>
<p><br /></p>
</div>
<div id="marginal-distribution-of-education-level" class="section level3">
<h3>Marginal Distribution of Education Level</h3>
<p>We will also examine the marginal distribution of the education level variable.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> city, <span class="kw">aes</span>(<span class="dt">x =</span> education)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw">stat_density</span>(<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Education level&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="04-simple-regression-description_files/figure-html/unnamed-chunk-5-1.png" alt="Density plot of employee education levels." width="50%" />
<p class="caption">
Figure 2: Density plot of employee education levels.
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># Summary statistics</span></a>
<a class="sourceLine" id="cb7-2" title="2">city <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="dt">M =</span> <span class="kw">mean</span>(education),</a>
<a class="sourceLine" id="cb7-5" title="5">    <span class="dt">SD =</span> <span class="kw">sd</span>(education)</a>
<a class="sourceLine" id="cb7-6" title="6">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1    16  4.36</code></pre>
<p>Again, we might write,</p>
<blockquote>
<p>The marginal distribution of education is unimodal with a mean of 16 years. There is variation in employees’ level of education (SD = 4.4).</p>
</blockquote>
<p><br /></p>
</div>
<div id="relationship-between-variables" class="section level3">
<h3>Relationship Between Variables</h3>
<p>Although examining the marginal distributions is an important first step, those descriptions do not help us directly answer our research question. To better understand any relationship between income and education level we need to explore how the distribution of income differs as a function of education. To do this, we will create a scatterplot of incomes versus education.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> city, <span class="kw">aes</span>(<span class="dt">x =</span> education, <span class="dt">y =</span> income)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Education (in years)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Income (in U.S. dollars)&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="04-simple-regression-description_files/figure-html/unnamed-chunk-7-1.png" alt="Scatterplot displaying the relationship between employee education levels and incomes." width="50%" />
<p class="caption">
Figure 3: Scatterplot displaying the relationship between employee education levels and incomes.
</p>
</div>
<p>The plot suggests a relationship (at least for these employees) between level of education and income. When describing the relationship we want to touch on four characteristics of the relationship:</p>
<ul>
<li>Functional form of the relationship</li>
<li>Direction</li>
<li>Strength</li>
<li>Observations that do not fit the trend (outliers)</li>
</ul>
<p><br /></p>
</div>
</div>
<div id="statistical-model-mathematical-description-of-the-data" class="section level2">
<h2>Statistical Model: Mathematical Description of the Data</h2>
<p>Since the relationship’s functional form seems reasonably linear, we will use a <em>linear model</em> to describe the data. We can express this model mathematically as,</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1(X_i) + \epsilon_i
\]</span></p>
<p>In this equation,</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the outcome/response value; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept of the line that best fits the data; it does not vary across individuals.</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope of the line that best fits the data; it does not vary across individuals.</li>
<li><span class="math inline">\(X_i\)</span> is the predictor value; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
</ul>
<p>The linear statistical model (i.e., the regression model) can be separated into two components: a <em>systematic</em> (or fixed) component and a <em>random</em> (or stochastic) component.</p>
<p><span class="math display">\[
Y_i = \underbrace{\beta_0 + \beta_1(X_i)}_{\substack{\text{Systematic} \\ \text{(Fixed)}}} + \underbrace{\epsilon_i}_{\substack{\text{Random} \\ \text{(Stochastic)}}}
\]</span></p>
<p><br /></p>
<div id="systematic-part-of-the-statistical-model" class="section level3">
<h3>Systematic Part of the Statistical Model</h3>
<p>The systematic (fixed) part of the equation gives the mean value of <span class="math inline">\(Y\)</span> given a particular <span class="math inline">\(X\)</span>-value. The mean of <span class="math inline">\(Y\)</span> given a particular <span class="math inline">\(X\)</span>-value is referred to as a <em>conditional mean</em> of <span class="math inline">\(Y\)</span>. The notation for the conditional mean of <span class="math inline">\(Y\)</span> given a particular <span class="math inline">\(X\)</span> value is <span class="math inline">\(\mu_{Y \vert X_i}\)</span>. We express the systematic part of the linear regression model mathematically as,</p>
<p><span class="math display">\[
\mu_{Y \vert X_i} = \beta_0 + \beta_1(X_i)
\]</span></p>
<p>Note that the systematic part of the equation does not include the error term. The error term is a part of the random component of the model. Statisticians also use <span class="math inline">\(\hat{Y_i}\)</span> to indicate the conditional mean of <span class="math inline">\(Y\)</span> at a particular <span class="math inline">\(X\)</span>. Thus, the systematic part of the linear regression model can also be written as,</p>
<p><span class="math display">\[
\hat{Y_i} = \beta_0 + \beta_1(X_i)
\]</span></p>
<p>The terms <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the systematic part of the model are referred to as the <em>regression parameters</em>. One of the primary goals of a regression analysis is to estimate the values of the regression parameters (i.e., the intercept and slope terms). Thus the systematic part of the regression model is a description, in mathematical form, of how the conditional mean <span class="math inline">\(Y\)</span> is related to <span class="math inline">\(X\)</span>. The equation here indicates that the conditional mean of <span class="math inline">\(Y\)</span> (<span class="math inline">\(\hat{Y_i}\)</span>) is a linear function of <span class="math inline">\(X\)</span>. This implies that <em>the conditional mean value of <span class="math inline">\(Y\)</span> differs by a constant amount for a constant difference in <span class="math inline">\(X\)</span></em>.</p>
<p>For example, the difference between the mean income for those employees who have 10 years of education and those that have 11 years of education <em>is the same as</em> the difference between the mean income for those employees who have 17 years of education and those that have 18 years of education. Or, the difference between the mean income for those employees who have 4 years of education and those that have 8 years of education <em>is the same as</em> the difference between the mean income for those employees who have 20 years of education and those that have 24 years of education.</p>
<p><br /></p>
</div>
<div id="visual-representation-of-the-regression-model" class="section level3">
<h3>Visual Representation of the Regression Model</h3>
<p>To help better understand the model, consider the following plot:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<img src="figs/conditional-means.png" alt="Plot displaying conditional distribution of $Y$ at several $X$ values. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for each conditional distribution." width="50%" />
<p class="caption">
Figure 4: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at several <span class="math inline">\(X\)</span> values. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for each conditional distribution.
</p>
</div>
<p>At each value of <span class="math inline">\(X\)</span> there is a distribution of <span class="math inline">\(Y\)</span>. For example, there would be a distribution of incomes for the employees with an education level of 10 years (in the population). There would be another distribution of incomes for the employees with an education level of 11 years (in the population). And so on. These are the conditional distributions of <span class="math inline">\(Y\)</span>.</p>
<p>Each conditional distribution of <span class="math inline">\(Y\)</span> has a mean; the conditional mean or <span class="math inline">\(\hat{Y_i}\)</span>. These conditional means are can be connected using a line. This is what it means to be able to express the conditional mean of <span class="math inline">\(Y\)</span> as a linear function of <span class="math inline">\(X\)</span>, or to say that the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is linear.</p>
<p><br /></p>
</div>
<div id="random-part-of-the-statistical-model" class="section level3">
<h3>Random Part of the Statistical Model</h3>
<p>From the visual representation of the model, we can see that there is a distribution of <span class="math inline">\(Y\)</span>-values at each <span class="math inline">\(X\)</span>-value; this is represented by the normal distributions in the picture. In our example, there are many employees who have the same education level, but have different incomes. The error term in the statistical model accounts for this variation in <span class="math inline">\(Y\)</span> for those cases that have the same <span class="math inline">\(X\)</span>-value. Mathematically we can understand this by re-writing the statistical model, substituting <span class="math inline">\(\mu_{Y \vert X_i}\)</span> in to the systematic part of the model.</p>
<p><span class="math display">\[
\begin{split}
Y_i &amp;= \beta_0 + \beta_1(X_i) + \epsilon_i \\
Y_i &amp;= \mu_{Y \vert X_i} + \epsilon_i
\end{split}
\]</span></p>
<p>This equation implies that each observed <span class="math inline">\(Y\)</span>-value is the sum of the conditional mean value of <span class="math inline">\(Y\)</span> (which is based on the <span class="math inline">\(X\)</span>-value) and some <em>residual</em> (or error) term. Re-arranging the terms, we can mathematically express the residual term as,</p>
<p><span class="math display">\[
\epsilon_i = Y_i - \mu_{Y \vert X_i}
\]</span></p>
<p>Or, using the <span class="math inline">\(\hat{Y_i}\)</span> notation,</p>
<p><span class="math display">\[
\epsilon_i = Y_i - \hat{Y_i}
\]</span></p>
<p>To compute an observation’s residual, we compute the difference between the observation’s <span class="math inline">\(Y\)</span>-value and its conditional mean value. When the observed value of <span class="math inline">\(Y\)</span> is larger than the conditional mean value of <span class="math inline">\(Y\)</span> the residual term will be positive (underprediction). If the observed value of <span class="math inline">\(Y\)</span> is smaller than the conditional mean value of <span class="math inline">\(Y\)</span> the residual term will be negative (overprediction).</p>
<p>To further understand the residual term, consider the plot below. This figure shows the relationship between education and income we plotted earlier, and also includes the regression line.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="04-simple-regression-description_files/figure-html/unnamed-chunk-9-1.png" alt="Scatterplot displaying the relationship between employee education levels and incomes. The OLS fitted regression line is also displayed." width="50%" />
<p class="caption">
Figure 5: Scatterplot displaying the relationship between employee education levels and incomes. The OLS fitted regression line is also displayed.
</p>
</div>
<p>Consider the three employees that have an education level of 10 years. The conditional mean income for these three employees is approximately $37,800. This is denoted by the blue point. Remember, the conditional means are on the regression line. The error (residual) term allows for discrepancy between the conditional mean of <span class="math inline">\(Y\)</span> and the observed <span class="math inline">\(Y\)</span>. In other words, none of these three employees have an actual income of $37,800. The residual represents the difference between the employee’s observed income and the conditional mean income based on their education level.</p>
<p>Graphically, the residual is represented by the vertical distance between the line and a given point on the scatterplot. Some of those points are above the line (they have a positive residual) and some are below the line (they have a negative residual). Also note that for some observations the error term is smaller than for others.</p>
<p><br /></p>
</div>
</div>
<div id="estimating-parameters-in-the-regression-model" class="section level2">
<h2>Estimating Parameters in the Regression Model</h2>
<p>The regression model describes the relationship between <span class="math inline">\(Y\)</span>-values and <span class="math inline">\(X\)</span>-values in the <em>population</em>. Every term in the model denoted using a Greek letter is an unknown <em>parameter</em> in this model. In the model we have written there are three unknown parameters denoted in the model: the intercept term (<span class="math inline">\(\beta_0\)</span>), the slope term (<span class="math inline">\(\beta_1\)</span>), and the residual term (<span class="math inline">\(\epsilon_i\)</span>).<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>In most statistical analyses, you will use a <em>sample</em> of data (not the entire population) to estimate the parameter values. Because a sample is only a subset of the population, the values we obtain for the parameters are imperfect estimates. To denote that the parameters are sample-based estimates, we add a hat to each parameter we are estimating. For example, estimates of the parameter estimates of <span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span> (referred to as <em>regression coefficients</em>) are typically reported in a regression analysis and should include hats.</p>
<p>Applied researchers and statisticians tend to focus their analysis on the systematic (fixed) part of the model, and are thus often most interested in the values of the regression coefficients. <em>After fitting the model to data</em>, the estimated conditional means can be expressed mathematically as:</p>
<p><span class="math display">\[
\hat\mu_{Y \vert X_i} = \hat\beta_0 + \hat\beta_1(X_i)
\]</span></p>
<p>Or, using the notation <span class="math inline">\(\hat{Y}_i\)</span> rather than <span class="math inline">\(\hat\mu_{Y \vert X_i}\)</span>, as:</p>
<p><span class="math display">\[
\hat{Y_i} = \hat\beta_0 + \hat\beta_1(X_i)
\]</span></p>
<p>We use the hats when we are indicating sample-based estimates of these values, so hats should be used when you are reporting the values obtained <em>after</em> using a sample of data to obtain the values.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The two estimated parameters of interest here (<span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span>) are referred to as the <em>estimated regression coefficients</em>, and this equation is often referred to as the <em>fitted regression equation</em>, or simply the <em>fitted equation</em>.</p>
<p><br /></p>
<!-- $$ -->
<!-- Y_i = \hat\beta_0 + \hat\beta_1(X_i) + \hat\epsilon_i -->
<!-- $$ -->
<!--  -->
<!--  This is called the *fitted regression model* since it is obtained after fitting the regression model to a sample of data.  -->
<p><br /></p>
<div id="estimating-residuals" class="section level3">
<h3>Estimating Residuals</h3>
<p>Note that we can also use the estimated regression coefficients to obtain estimates for the residuals, often referred to as the <em>observed residuals</em>. Here we make use of the earlier idea that the residual term was the difference between the observed value of <span class="math inline">\(Y\)</span> and the conditional mean of <span class="math inline">\(Y\)</span> for a given <span class="math inline">\(X\)</span>-value. Mathematically,</p>
<p><span class="math display">\[
\epsilon_i = Y_i - \mu_{Y \vert X_i}
\]</span></p>
<p>Once we use data to obtain estimates for the intercept and slope (<span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span>) we can substitute those into the fitted equation and obtain an estimate for the conditional mean (<span class="math inline">\(\hat{\mu}_{Y \vert X_i}\)</span>). This value can then be used to obtain an estimate for the residual.</p>
<p><span class="math display">\[
\hat\epsilon_i = Y_i - \hat{\mu}_{Y \vert X_i}
\]</span></p>
<p>Or, using the “Y-hat” notation,</p>
<p><span class="math display">\[
\hat\epsilon_i = Y_i - \hat{Y_i}
\]</span></p>
<p>Remember, the hat on the residual indicates it is an estimate based on values obtained from the data!</p>
<p><br /></p>
</div>
</div>
<div id="fitting-a-regression-model-to-data-using-r" class="section level2">
<h2>Fitting a Regression Model to Data Using R</h2>
<p>To fit the regression model to data using R, we will use the <code>lm()</code> function. The syntax for this function looks like this:</p>
<blockquote>
<p><code>lm(</code><strong>outcome</strong> ~ <code>1 +</code> <strong>predictor</strong>, <code>data =</code> <strong>dataframe</strong><code>)</code></p>
</blockquote>
<p>where <strong>outcome</strong> is the name of the outcome/response variable, <strong>predictor</strong> is the name of the predictor variable, and <strong>dataframe</strong> is the name of the data frame. (The <code>1</code> on the right side of the tilde tells R to include the intercept in its computation.) When we fit a regression model in R, we will also assign the output to a new object in R. Below, we fit the model using education level to predict income. Here the output is assigned to an object called <code>lm.1</code>. We can print the regression parameter estimates by typing the <code>lm()</code> object name and hitting enter.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># Fit regression model</span></a>
<a class="sourceLine" id="cb10-2" title="2">lm<span class="fl">.1</span> =<span class="st"> </span><span class="kw">lm</span>(income <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>education, <span class="dt">data =</span> city)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co"># Print regression coefficients</span></a>
<a class="sourceLine" id="cb10-5" title="5">lm<span class="fl">.1</span></a></code></pre></div>
<pre><code>
Call:
lm(formula = income ~ 1 + education, data = city)

Coefficients:
(Intercept)    education  
     11.321        2.651  </code></pre>
<p>Here the parameter estimates (or regression coefficients) are:</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0 = 11.321\)</span></li>
<li><span class="math inline">\(\hat{\beta}_1 = 2.651\)</span></li>
</ul>
<p>Remember that these are estimates and need the hats. The systematic part of the fitted regression model (or <em>fitted equation</em>) is:</p>
<p><span class="math display">\[
\hat{\mathrm{Income}_i} = 11.321 + 2.651(\mathrm{Education~Level}_i)
\]</span></p>
<p><br /></p>
<div id="intercept-interpretation" class="section level3">
<h3>Intercept Interpretation</h3>
<p>The estimate for the intercept was 11.321. Graphically, this value indicates the value where the line passes through the <span class="math inline">\(y\)</span>-axis (i.e., <span class="math inline">\(y\)</span>-intercept). As such, it gives the <span class="math inline">\(\hat{Y}_i\)</span> or predicted value when <span class="math inline">\(X = 0\)</span>. Algebraically we get the same thing if we substitute 0 in for <span class="math inline">\(X_i\)</span> in the fitted regression equation.</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_i &amp;= \hat{\beta}_0 + \hat{\beta}_1(0) \\
\hat{Y}_i &amp;= \hat{\beta}_0
\end{split}
\]</span></p>
<p>To interpret this value, remember that <span class="math inline">\(\hat{Y}_i\)</span> is a conditional mean. In this case, it represents the model predicted mean income for all employees that have an education level of 0 years. Graphically this looks like the following.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<img src="figs/conditional-means-intercept.png" alt="Plot displaying conditional distribution of $Y$ at $X=0$. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for this conditional distribution---which corresponfds to the intercept value of the regression line." width="50%" />
<p class="caption">
Figure 6: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at <span class="math inline">\(X=0\)</span>. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for this conditional distribution—which corresponfds to the intercept value of the regression line.
</p>
</div>
<p>Interpreting the intercept coefficient from our example,</p>
<blockquote>
<p>The model predicted mean income for all employees that have an education level of 0 years is $11,321.</p>
</blockquote>
<p><br /></p>
</div>
<div id="slope-interpretation" class="section level3">
<h3>Slope Interpretation</h3>
<p>Recall from algebra that the slope of a line describes the change in <span class="math inline">\(Y\)</span> versus the change in <span class="math inline">\(X\)</span>. In regression, the slope describes the <em>predicted</em> change in <span class="math inline">\(\hat{Y}\)</span> for a one-unit difference in <span class="math inline">\(X\)</span>. In our example,</p>
<p><span class="math display">\[
\hat{\beta}_1 = \frac{\Delta\hat{Y}}{\Delta X} = \frac{2.651}{1}
\]</span></p>
<p>Again, because <span class="math inline">\(\hat{Y}\)</span> is a conditional mean, the slope represents the difference in predicted mean incomes for each one-year difference in education level. Graphically,</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<img src="figs/conditional-means-slope.png" alt="Plot displaying conditional distribution of $Y$ at $X=0$ and $X=1$. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for these conditional distributions---the relative change which corresponds to the slope value of the regression line." width="50%" />
<p class="caption">
Figure 7: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at <span class="math inline">\(X=0\)</span> and <span class="math inline">\(X=1\)</span>. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for these conditional distributions—the relative change which corresponds to the slope value of the regression line.
</p>
</div>
<p>Interpreting the slope coefficient in our example,</p>
<blockquote>
<p>Each one-year difference in education level is associated with a model predicted difference of $2,651 in mean income.</p>
</blockquote>
<p>To better understand this, consider the mean income for city employees with three different education levels. The first set of employees have an education level of 10 years. The second set have an education level of 11 years, and the third set have an education level of 12 years. Now let’s compute each set of employees’ mean income using the estimated regression coefficients.</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Education=10:~}\hat{\mathrm{Income}} &amp;= 11.321 + 2.651(10) \\
&amp;= 37.831
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\mathbf{Education=11:~}\hat{\mathrm{Income}} &amp;= 11.321 + 2.651(11) \\
&amp;= 40.482
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\mathbf{Education=12:~}\hat{\mathrm{Income}} &amp;= 11.321 + 2.651(12) \\
&amp;= 43.133
\end{split}
\]</span></p>
<p>Each set of employees’ education levels differ by one year (10 to 11 to 12). The difference in predicted mean incomes for these employees differs by 2.651 thousand dollars.</p>
<p><br /></p>
</div>
<div id="estimating-residuals-1" class="section level3">
<h3>Estimating Residuals</h3>
<p>Consider the 25th case in the data frame.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">city <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">25</span>)</a></code></pre></div>
<pre><code># A tibble: 1 x 6
  education income seniority gender  male party      
      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;      
1        20   54.7        12 female     0 Independent</code></pre>
<p>This employee (Employee 25) has an education level of 20 years (<span class="math inline">\(X_{25}=20\)</span>). Her income is 54.672 thousand dollars (<span class="math inline">\(Y_{25}=54.672\)</span>). Using the fitted regression equation, we can compute the model predicted mean income for employees with 20 years of education as,</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># Y_hat = b0 + b1 * X</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="fl">11.321</span> <span class="op">+</span><span class="st"> </span><span class="fl">2.651</span> <span class="op">*</span><span class="st"> </span><span class="dv">20</span></a></code></pre></div>
<pre><code>[1] 64.341</code></pre>
<p><span class="math display">\[
\hat{Y}_{25} = 64.341
\]</span></p>
<p>We could also report this using the conditional mean notation,</p>
<p><span class="math display">\[
\hat\mu_{Y \vert X=20} = 64.341
\]</span></p>
<p>Now we can use the estimated conditional mean to also compute Employee 25’s residual.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># e = Y - Y_hat</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="fl">54.672</span> <span class="op">-</span><span class="st"> </span><span class="fl">64.341</span></a></code></pre></div>
<pre><code>[1] -9.669</code></pre>
<p>Using mathematical notation,</p>
<p><span class="math display">\[
\hat\epsilon_{25} = -9.669
\]</span></p>
<p>The negative residual, <span class="math inline">\(\hat\epsilon_{25} = -9.669\)</span>, suggests that this employee earns $9,669 less than the average predicted income for employees with 20 years of education. We can also represent these values graphically.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="04-simple-regression-description_files/figure-html/unnamed-chunk-16-1.png" alt="Plot displaying the OLS fitted regression line (blue) between employee education levels and incomes. The 25th employee's observed data (black dot) is plotted, and a visual representation of the employee's residual (red line) is also displayed." width="50%" />
<p class="caption">
Figure 8: Plot displaying the OLS fitted regression line (blue) between employee education levels and incomes. The 25th employee’s observed data (black dot) is plotted, and a visual representation of the employee’s residual (red line) is also displayed.
</p>
</div>
<p><br /></p>
</div>
</div>
<div id="answering-the-research-question" class="section level2">
<h2>Answering the Research Question</h2>
<p>Remember that this whole analysis was driven because we wanted to answer a question, namely whether education level is related to income for the Riverview employees. The results from the regression analysis allows us to answer this question.</p>
<blockquote>
<p>To answer the question of whether education level is related to income, a linear regression model was fitted to the data using ordinary least squares estimation. The results of this analysis suggested that education level is positively related to income for the 32 employees (<span class="math inline">\(\hat\beta_1 = 2.65\)</span>). Each year of education is associated with a $2,651 difference in income, on average.</p>
</blockquote>
<p>Here the regression analysis provides a quantitative summary of the relationship between education level and income. It provides us information about the direction of the relationship (positive) and the magnitude of that relationship. Although this can give us a description of the realtionship, it is only for the sample of data you looked at (i.e., for these 32 employees). To make further statements about whether there is a relationship between education level and income in a broader popualtion (e.g., all Riverview employees, or all California residents), we need more information, namely <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3105563/">whether the sample is representative of the larger population</a> and also statistical information about the amount of sampling error we have. (We will cover sampling error in Chapter 5.)</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Technically there are many unknown residuals, one for each case, but the assumptions we put on the linear model make it so that we only care about the variance of the residuals, hence a single unknown.<a href="simple-linear-regressiondescription.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Sometimes people use Roman letters when referring to sample estimates rather than hatting the Greek letters. For example, the sample-based equation might be denoted: <span class="math inline">\(\hat{Y}_i = b_0 + b_1(X_i) + e_i\)</span>.<a href="simple-linear-regressiondescription.html#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
<p style="text-align: center;">
<a href="preface.html"><button class="btn btn-default">Previous</button></a>
<a href="references-1.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
